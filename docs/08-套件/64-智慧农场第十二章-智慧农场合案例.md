# 第十二章 智慧农场综合案例

## 1、简介

此章节是综合了前边的几个章节的综合案列，将所有传感器和模块连接到Arduino UNO主板上，通过蓝牙模块连接到我们的蓝牙BLE遥控软件（<https://ble.openjumper.com/connect>）上。用户可以监测农场的环境数据，并控制农场设备，包括灯光、风扇、加热、浇水等。

## 2、课程目标

+ 学会搭建智慧农场外观

+ 学习控制各模块的编程

## 3、器材准备

+ Arduino UNO主控板*1

+ 传感器扩展板*1

+ 蓝牙模块*1

+ 高亮LED模块*1

+ SHT30温湿度传感器*1

+ 光照强度传感器*1

+ 土壤湿度传感器*1

+ CO2传感器*1

+ 电机风扇模块*1

+ 扇叶*1

+ OLED显示屏*1

+ MOS管模块*2

+ 加热模块*1

+ 180度9g舵机*1

+ 水泵*1

+ 杜邦线*10

+ USB数据线*1



## 4、硬件连接

可根据之前的章节进行连线。

+ 将高亮LED模块用3P杜邦线连接到传感器扩展板的数字接口D5（黄线S—D5，红线VCC—5V，黑线GND—GND）；

+ SHT30温湿度传感器4P杜邦线连接到传感器扩展板的IIC接口（蓝线D—SDA，绿线C—SCL,红线VCC—5V，黑线GND—GND）（连第2个IIC接口）；

+ 光将光线传感器用4P杜邦线连接到传感器扩展板的IIC接口（蓝线D—SDA，绿线C—SCL,红线VCC—5V，黑线GND—GND）（连第1个IIC接口）;

+ 土壤湿度传感器用3P杜邦线连接到传感器扩展板的模拟接口A3（黄线S—A3，红线VCC—5V，黑线GND—GND）；

+ CO2传感器用4P杜邦线连接到传感器扩展板的串口（蓝线RX—D6，绿线TX-D7，红线VCC—5V，黑线GND—GND）；

+ 电机风扇模块用3P杜邦线连接到传感器扩展板的数字接口D3（黄线S—D3，红线VCC—5V，黑线GND—GND）；

+ 将加热模块连接在MOS管（红线接V+，黑线接V-）上，MOS管模块用3P杜邦线连接到传感器扩展板的数字接口D10（黄线S—D10，红线VCC—5V，黑线GND—GND）；

+ 将水泵连接在MOS管（红线接V+，黑线接V-）上，MOS管模块用3P杜邦线连接到传感器扩展板的数字接口D11（黄线S—D11，红线VCC—5V，黑线GND—GND）;

+ OLED显示屏用4P杜邦线连接到IIC接口（蓝线D—A4，绿线C—A5,红线VCC—5V，黑线GND—GND）；

+ 将180度9g舵机连接到传感器扩展板的数字接口D4（黄线S—D4，红线VCC—5V，黑线GND—GND）；

+ 蓝牙模块用4P杜邦线连接到传感器扩展板的串口（蓝线RX—D8，绿线TX—D9，红线VCC—5V，黑线GND—GND）

确保所有连接都正确无误。

连线图

## 5、实验程序

将以下程序复制到Arduino IDE中，选择好主板和对应的端口，编译上传程序。
```C
//缺程序
```

## 6、观察现象

将这段代码上传到Arduino UNO R3主板上，然后打开蓝牙控制端，点击连接设备，连接成功后打开智慧农场界面，就可以在移动端监测传感器的各项数据及控制模块执行发出的指令啦。

例如：打开补光灯、关闭补光灯，打开水泵，关闭水泵，打开风扇、关闭风扇，打开加热器、关闭加热器等。还可以在移动端输入想要显示的信息显示在OLED显示屏上。


（蓝牙控制端：<https://ble.openjumper.com/connect>）
